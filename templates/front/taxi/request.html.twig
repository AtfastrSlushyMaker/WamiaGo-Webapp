{# filepath: d:\WamiaGo-Webapp - Copie (3)\templates\front\taxi\taxi-management.html.twig #}
{% extends 'front/base.html.twig' %}

{% block title %}Taxi Management - WamiaGo{% endblock %}

{% block page_stylesheets %}
<link href="{{ asset('css/front/taxi/taxi-management.css') }}?v={{ 'now'|date('YmdHi') }}" rel="stylesheet">
<link href="https://unpkg.com/leaflet/dist/leaflet.css" rel="stylesheet">
<style>
    .hero-section {
        background-image: url('{{ asset('images/front/taxi/hero-bg.jpg') }}');
        background-size: cover;
        background-position: center;
        padding: 50px 0;
    }

    .hero-section .container {
        padding-top: 60px;
    }

    .form-container {
        background: #fff;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .form-container h3 {
        font-size: 1.8rem;
        margin-bottom: 20px;
    }

    .form-control {
        border-radius: 5px;
        border: 1px solid #ddd;
        padding: 10px;
        margin-bottom: 15px;
    }

    .form-control:focus {
        border-color: #007bff;
        box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
    }

    .btn-primary {
        background-color: #66b3ff;  /* Light blue background */
        border: none;
        padding: 12px 24px;
        font-size: 16px;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .btn-primary:hover {
        background-color: #3380cc;  /* Darker blue on hover */
    }

    .map-container {
        height: 400px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
</style>
{% endblock %}

{% block hero %}
<div class="hero-section text-white py-5">
    <div class="container text-start">
        <h1 class="display-4 fw-bold">Request a Taxi</h1>
        <p class="lead">Easily manage your taxi requests and find the perfect ride with just a few clicks</p>
        <div class="d-flex">
            <a href="#requests-section" class="btn btn-light btn-lg me-3">
                <i class="fas fa-taxi me-2"></i> Back to Request List <i class="fas fa-chevron-right ms-2"></i>
            </a>

        </div>
    </div>
</div>
{% endblock %}



{% block content %}
<div class="container py-5" id="requests-section">
    <div class="row">
        <div class="col-md-6">
            <div class="form-container">
                <h3>Request a Taxi</h3>
                <form id="requestForm" action="#" method="POST">
                    <!-- Pickup Location -->
                    <div class="mb-3">
                        <label for="pickupLocation" class="form-label">Pickup Location</label>
                        <select class="form-control" id="pickupLocation" name="pickupLocation" required>
                            <option value="">Select Pickup Location</option>
                            <option value="36.8065,10.1815">Tunis</option>
                            <option value="37.2767,9.8766">Sfax</option>
                            <option value="35.8256,10.6406">Sousse</option>
                        </select>
                    </div>

                    <!-- Arrival Location -->
                    <div class="mb-3">
                        <label for="arrivalLocation" class="form-label">Arrival Location</label>
                        <select class="form-control" id="arrivalLocation" name="arrivalLocation" required>
                            <option value="">Select Arrival Location</option>
                            <option value="36.8065,10.1815">Tunis</option>
                            <option value="37.2767,9.8766">Sfax</option>
                            <option value="35.8256,10.6406">Sousse</option>
                        </select>
                    </div>

                    <button type="submit" class="btn btn-primary w-100">Submit Request</button>
                </form>
            </div>
        </div>

        <!-- Map Section -->
        <div class="col-md-6">
            <div id="map" class="map-container"></div>
        </div>
    </div>
</div>
{% endblock %}

{% block javascripts %}
{{ parent() }}
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    // Initialize the map (Leaflet.js example centered on Tunisia)
    var map = L.map('map').setView([33.8869, 9.5375], 6); // Default center: Tunisia (latitude: 33.8869, longitude: 9.5375)

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    // Function to update the map with the selected locations
    function updateMap(pickupCoords, arrivalCoords) {
        // Clear existing markers (if any)
        map.eachLayer(function(layer) {
            if (layer instanceof L.Marker) {
                map.removeLayer(layer);
            }
        });

        // Add markers for the selected pickup and arrival locations
        var pickupLocation = pickupCoords.split(',');
        var arrivalLocation = arrivalCoords.split(',');

        // Add pickup marker
        L.marker([parseFloat(pickupLocation[0]), parseFloat(pickupLocation[1])])
            .addTo(map)
            .bindPopup('Pickup Location')
            .openPopup();

        // Add arrival marker
        L.marker([parseFloat(arrivalLocation[0]), parseFloat(arrivalLocation[1])])
            .addTo(map)
            .bindPopup('Arrival Location');

        // Adjust map view to fit both markers
        var bounds = [
            [parseFloat(pickupLocation[0]), parseFloat(pickupLocation[1])],
            [parseFloat(arrivalLocation[0]), parseFloat(arrivalLocation[1])]
        ];
        map.fitBounds(bounds);
    }

    // Listen for form submission to update map
    document.getElementById('requestForm').addEventListener('submit', function(event) {
        event.preventDefault();

        var pickupLocation = document.getElementById('pickupLocation').value;
        var arrivalLocation = document.getElementById('arrivalLocation').value;

        if (pickupLocation && arrivalLocation) {
            updateMap(pickupLocation, arrivalLocation);
        }
    });



</script>
{% endblock %}
