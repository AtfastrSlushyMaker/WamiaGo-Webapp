<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Password Field</title>
  <style>
    /* Password Field Styles */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: #333;
      margin: 0;
      padding: 20px;
    }

    .password-container {
      position: relative;
      width: 100%;
      max-width: 300px;
      margin: 20px 0;
    }

    .password-field {
      width: 100%;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 16px;
      padding-right: 45px; /* Space for the toggle button */
    }

    /* Toggle button styles */
    .toggle {
      position: absolute;
      top: 50%;
      right: 15px;
      transform: translateY(-50%);
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      border: none;
      background: none;
      color: #555;
      cursor: pointer;
      padding: 0;
    }

    .toggle:focus {
      outline: none;
      color: #333;
    }

    .toggle svg {
      width: 24px;
      height: 24px;
      pointer-events: none;
    }

    .toggle .lid {
      transition: transform 0.2s ease;
    }

    .toggle .eye {
      transition: transform 0.2s ease;
    }    .toggle[aria-pressed="true"] .lid--upper {
      transform: translateY(3.5px);
      opacity: 0 !important; /* Force hide upper lid */
      visibility: hidden;
    }
    
    /* Hide the eye pupil when closed */
    .toggle[aria-pressed="true"] .eye {
      opacity: 0 !important; /* Force hide eye */
      visibility: hidden;
    }/* Password reveal ripple effect */
    .password-field {
      transition: all 0.3s ease;
    }

    .password-field.reveal {
      animation: ripple 0.6s ease-out;
    }
    
    /* Text animation */
    @keyframes textReveal {
      0% {
        color: transparent;
        text-shadow: 0 0 8px rgba(0,0,0,0.5);
      }
      100% {
        color: inherit;
        text-shadow: none;
      }
    }

    .password-field[type="text"] {
      animation: textReveal 0.5s ease-out forwards;
    }

    @keyframes ripple {
      0% {
        box-shadow: 0 0 0 0 rgba(66, 133, 244, 0.3);
      }
      70% {
        box-shadow: 0 0 0 10px rgba(66, 133, 244, 0);
      }
      100% {
        box-shadow: 0 0 0 0 rgba(66, 133, 244, 0);
      }
    }

    /* Screen reader only */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      border: 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Password Field with Animated Toggle</h1>
    <form>
      <div class="password-container">
        <input type="password" id="password" name="password" class="password-field" placeholder="Enter password" required>
        <button type="button" class="toggle" aria-label="Reveal password" aria-pressed="false">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <mask id="eye-open">
                <path d="M1 12C1 12 5 4 12 4C19 4 23 12 23 12V20H12H1V12Z" fill="#D9D9D9" stroke="black" stroke-width="1.5" stroke-linejoin="round" />
              </mask>
              <mask id="eye-closed">
                <path d="M1 12C1 12 5 20 12 20C19 20 23 12 23 12V20H12H1V12Z" fill="#D9D9D9" />
              </mask>
            </defs>
            <path class="lid lid--upper" d="M1 12C1 12 5 4 12 4C19 4 23 12 23 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
            <path class="lid lid--lower" d="M1 12C1 12 5 20 12 20C19 20 23 12 23 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
            <g mask="url(#eye-open)">
              <g class="eye">
                <circle cy="12" cx="12" r="4" fill="currentColor" />
                <circle cy="11" cx="13" r="1" fill="black" />
              </g>
            </g>
          </svg>
          <span class="sr-only">Reveal</span>
        </button>
      </div>
    </form>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Initialize all password toggle buttons
      document.querySelectorAll('.toggle').forEach(button => {
        // Find password input
        const input = button.previousElementSibling;
        
        // Ensure it's a password input
        if (!input || (input.type !== 'password' && input.type !== 'text')) return;
        
        // Animation state
        let busy = false;
        
        // Handle click event
        button.addEventListener('click', () => {
          // Prevent multiple clicks during animation
          if (busy) return;
          busy = true;
          
          const isPassword = input.type === 'password';
          
          // Update ARIA state
          button.setAttribute('aria-pressed', isPassword);
          
          // Get the upper eyelid
          const lidUpper = button.querySelector('.lid--upper');
          
          if (isPassword) {
            // Show password (close eye)
            lidUpper.style.transform = 'translateY(3.5px)';              // Change input type after animation and add ripple
            setTimeout(() => {
              // Store original value for text animation
              const value = input.value;
              
              // Change input type
              input.type = 'text';
              
              // Re-set value to trigger CSS animation
              input.value = value;
              
              // Add ripple effect
              input.classList.add('reveal');
              
              // Remove class after animation completes
              setTimeout(() => {
                input.classList.remove('reveal');
              }, 600);
              
              busy = false;
            }, 200);
          } else {
            // Hide password (open eye)
            lidUpper.style.transform = '';
            
            // Change input type after animation
            setTimeout(() => {
              input.type = 'password';
              busy = false;
            }, 200);
          }
        });
      });
    });
  </script>
</body>
</html>
